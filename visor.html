<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd">
<html>
<head>
    <title>Liris :: Visor de Procedimientos</title>
    <script>
        /**
         * Envolvemos toda la lógica en window.onload.
         * Esto asegura que el script se ejecute SÓLO después de que 
         * el <frameset> y sus <frame> hijos hayan sido parseados por el DOM.
         */
        window.onload = function() {
            console.log('DOM cargado. Buscando parámetros...');
            try {
                // 1. Obtiene los parámetros de la URL de ESTA PÁGINA (visor.html, esto pasarlo a producción)
                const urlParams = new URLSearchParams(window.location.search);
                const carpeta = urlParams.get('Carpeta') || '';
                const codEmp = urlParams.get('CodEmp') || '';
                const depId = urlParams.get('DepartMyProcessId') || '';

                // 2. Construye la URL correcta para el frame izquierdo
                const newSrc = `UserDocsF.aspx?Carpeta=${encodeURIComponent(carpeta)}&CodEmp=${encodeURIComponent(codEmp)}&DepartMyProcessId=${encodeURIComponent(depId)}`;
                console.log('URL del frame izquierdo:', newSrc);

                // 3. Encuentra el frame izquierdo y le asigna la URL
                // Ahora sí debería encontrarlo sin problemas.
                const fraList = document.getElementById('fraList');
                
                if (fraList) {
                    fraList.src = newSrc;
                } else {
                    // Este error ya no debería aparecer
                    console.error('Error: No se encontró el frame "fraList" (post-load).');
                }
            } catch (e) {
                console.error('Error en el script del visor:', e);
                // No se puede usar document.body.innerHTML en un frameset
                alert('Error crítico al cargar el visor.');
            }
        };
    </script>
</head>

<frameset id="fstMain" cols="50%,*" frameborder="1" framespacing="0" bordercolor="#c0c0c0">
    <frame id="fraList" runat="server" name="list" scrolling="yes" src="about:blank" /> 
    <frame id="fraSubmain" name="submain" scrolling="no" />
</frameset>

</html>